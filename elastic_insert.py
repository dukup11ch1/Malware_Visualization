import elasticsearch
import json
from time import time

def insert_data(data):
    chunksize, chunk, double_chunk = data["ssdeep_value"].split(':')
    chunksize = int(chunksize)
    
    # data는 아래와 같이 넘겨주세요.
    #
    # data = {
        # 'ssdeep': ssdeep값,
        # 'sha256': 파일sha256값,
        # 'group': 그룹 이름,
        # 'tag': ["이런식으로", "태그", "삽입", "없으면", "[]"],
        # 'block_representative': basic_block 대푯값,
        # 'block_count': 베이직 블록 번호,
        # 'opcode': 오피코드 전체,
    # }
    # insert_basic_block(data)

    es = elasticsearch.Elasticsearch(['localhost:9200'])

    document = {
        'chunksize': chunksize,
        'chunk': chunk,
        'double_chunk': double_chunk,
        'ssdeep': data["ssdeep_value"], #베이직 블록 SSDEEP 값
        'sha256': data["sha256"], 
        'group': data["group"],
        'tag': data["tag"],
        'block_representative': data["block_representative"], # 베이직 블록 함수 대푯값
        'block_count': data["block_count"],
        'opcode': data["opcode"],
        'disassemble': data["disassemble"],
    }

    es.index('basic_block', 'record', document)
    es.indices.refresh('basic_block')
    del(document)